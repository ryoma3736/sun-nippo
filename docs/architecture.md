# æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸ - ã‚µãƒ³ãƒˆãƒªãƒ¼å–¶æ¥­æ—¥å ±ã‚¢ãƒ—ãƒª

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå**: sun-nippo
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
**ä½œæˆæ—¥**: 2025-12-07

---

## ğŸ“ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### å…¨ä½“æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Frontend Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          Next.js 14 (App Router + RSC)                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚
â”‚  â”‚  â”‚   Pages  â”‚  â”‚Componentsâ”‚  â”‚ Contexts â”‚             â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ HTTP/HTTPS
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Backend Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            Next.js API Routes                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚
â”‚  â”‚  â”‚   Auth   â”‚  â”‚   CRUD   â”‚  â”‚  Logic   â”‚             â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚  â”‚                                                        â”‚  â”‚
â”‚  â”‚            Prisma ORM (Type-safe Query)               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Data Layer                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              PostgreSQL 15                             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚
â”‚  â”‚  â”‚  Users   â”‚  â”‚  Visits  â”‚  â”‚  Orders  â”‚             â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚  â”‚
â”‚  â”‚  â”‚  Reports â”‚  â”‚  Masters â”‚                           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ ãƒ¬ã‚¤ãƒ¤ãƒ¼è¨­è¨ˆ

### 1. ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆFrontendï¼‰

#### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **Framework**: Next.js 14 (App Router)
- **Language**: TypeScript 5.x
- **UI Library**: Tailwind CSS 3.x
- **State Management**: React Context API / Zustandï¼ˆæ¤œè¨ä¸­ï¼‰
- **Form Handling**: React Hook Form
- **Validation**: Zod

#### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ
```
src/
â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/               # èªè¨¼é–¢é€£ãƒšãƒ¼ã‚¸ï¼ˆã‚°ãƒ«ãƒ¼ãƒ—ï¼‰
â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ layout.tsx
â”‚   â”œâ”€â”€ (dashboard)/          # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆã‚°ãƒ«ãƒ¼ãƒ—ï¼‰
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ visits/           # è¨ªå•è¨˜éŒ²
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ new/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚       â””â”€â”€ edit/
â”‚   â”‚   â”‚           â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ orders/           # å—æ³¨
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ new/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚       â””â”€â”€ edit/
â”‚   â”‚   â”‚           â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ reports/          # æ—¥å ±
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ new/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ stores/           # åº—èˆ—ãƒã‚¹ã‚¿
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ products/         # å•†å“ãƒã‚¹ã‚¿
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ layout.tsx        # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰å…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”œâ”€â”€ api/                  # API Routes
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ visits/
â”‚   â”‚   â”œâ”€â”€ orders/
â”‚   â”‚   â”œâ”€â”€ reports/
â”‚   â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â””â”€â”€ products/
â”‚   â”œâ”€â”€ layout.tsx            # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â””â”€â”€ globals.css           # ã‚°ãƒ­ãƒ¼ãƒãƒ«CSS
â”œâ”€â”€ components/               # Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ ui/                   # å†åˆ©ç”¨å¯èƒ½ãªUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”œâ”€â”€ Input.tsx
â”‚   â”‚   â”œâ”€â”€ Select.tsx
â”‚   â”‚   â”œâ”€â”€ Table.tsx
â”‚   â”‚   â”œâ”€â”€ Card.tsx
â”‚   â”‚   â””â”€â”€ Modal.tsx
â”‚   â”œâ”€â”€ layout/               # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚   â”‚   â””â”€â”€ Footer.tsx
â”‚   â”œâ”€â”€ features/             # æ©Ÿèƒ½åˆ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ visits/
â”‚   â”‚   â”‚   â”œâ”€â”€ VisitForm.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ VisitList.tsx
â”‚   â”‚   â”‚   â””â”€â”€ VisitCard.tsx
â”‚   â”‚   â”œâ”€â”€ orders/
â”‚   â”‚   â”‚   â”œâ”€â”€ OrderForm.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ OrderList.tsx
â”‚   â”‚   â”‚   â””â”€â”€ OrderItemRow.tsx
â”‚   â”‚   â””â”€â”€ reports/
â”‚   â”‚       â”œâ”€â”€ ReportForm.tsx
â”‚   â”‚       â”œâ”€â”€ ReportList.tsx
â”‚   â”‚       â””â”€â”€ ReportSummary.tsx
â”‚   â””â”€â”€ providers/            # Context Providers
â”‚       â”œâ”€â”€ AuthProvider.tsx
â”‚       â””â”€â”€ ThemeProvider.tsx
â”œâ”€â”€ lib/                      # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ»ãƒ˜ãƒ«ãƒ‘ãƒ¼
â”‚   â”œâ”€â”€ prisma.ts             # Prisma Client
â”‚   â”œâ”€â”€ auth.ts               # NextAuthè¨­å®š
â”‚   â”œâ”€â”€ validations.ts        # Zodã‚¹ã‚­ãƒ¼ãƒ
â”‚   â””â”€â”€ utils.ts              # æ±ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ types/                    # TypeScriptå‹å®šç¾©
â”‚   â”œâ”€â”€ api.ts
â”‚   â”œâ”€â”€ models.ts
â”‚   â””â”€â”€ index.ts
â””â”€â”€ hooks/                    # ã‚«ã‚¹ã‚¿ãƒ React Hooks
    â”œâ”€â”€ useAuth.ts
    â”œâ”€â”€ useVisits.ts
    â”œâ”€â”€ useOrders.ts
    â””â”€â”€ useReports.ts
```

---

### 2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆBackendï¼‰

#### Next.js API Routesè¨­è¨ˆ

**RESTful APIè¨­è¨ˆåŸå‰‡**:
- ãƒªã‚½ãƒ¼ã‚¹æŒ‡å‘ã®URLè¨­è¨ˆ
- HTTPãƒ¡ã‚½ãƒƒãƒ‰ã®é©åˆ‡ãªä½¿ç”¨ï¼ˆGET, POST, PUT, DELETEï¼‰
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã®çµ±ä¸€ï¼ˆ200, 201, 400, 401, 404, 500ï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æ¨™æº–åŒ–

#### API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¨­è¨ˆ

##### èªè¨¼API (`/api/auth/*`)
```typescript
// NextAuth.jsæ¨™æº–ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
POST   /api/auth/signin        // ãƒ­ã‚°ã‚¤ãƒ³
POST   /api/auth/signout       // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
GET    /api/auth/session       // ã‚»ãƒƒã‚·ãƒ§ãƒ³å–å¾—
GET    /api/auth/csrf          // CSRFãƒˆãƒ¼ã‚¯ãƒ³å–å¾—

// ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
POST   /api/auth/register      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ï¼ˆADMINå°‚ç”¨ï¼‰
```

##### è¨ªå•è¨˜éŒ²API (`/api/visits/*`)
```typescript
GET    /api/visits             // è¨ªå•è¨˜éŒ²ä¸€è¦§å–å¾—
POST   /api/visits             // è¨ªå•è¨˜éŒ²ä½œæˆ
GET    /api/visits/:id         // è¨ªå•è¨˜éŒ²è©³ç´°å–å¾—
PUT    /api/visits/:id         // è¨ªå•è¨˜éŒ²æ›´æ–°
DELETE /api/visits/:id         // è¨ªå•è¨˜éŒ²å‰Šé™¤
```

##### å—æ³¨API (`/api/orders/*`)
```typescript
GET    /api/orders             // å—æ³¨ä¸€è¦§å–å¾—
POST   /api/orders             // å—æ³¨ä½œæˆ
GET    /api/orders/:id         // å—æ³¨è©³ç´°å–å¾—
PUT    /api/orders/:id         // å—æ³¨æ›´æ–°
DELETE /api/orders/:id         // å—æ³¨å‰Šé™¤
GET    /api/orders/stats       // å£²ä¸Šçµ±è¨ˆå–å¾—
```

##### æ—¥å ±API (`/api/reports/*`)
```typescript
GET    /api/reports            // æ—¥å ±ä¸€è¦§å–å¾—
POST   /api/reports            // æ—¥å ±ä½œæˆ
GET    /api/reports/:id        // æ—¥å ±è©³ç´°å–å¾—
PUT    /api/reports/:id        // æ—¥å ±æ›´æ–°
POST   /api/reports/:id/submit // æ—¥å ±æå‡º
POST   /api/reports/:id/approve // æ—¥å ±æ‰¿èªï¼ˆMANAGERå°‚ç”¨ï¼‰
POST   /api/reports/:id/reject  // æ—¥å ±å·®ã—æˆ»ã—ï¼ˆMANAGERå°‚ç”¨ï¼‰
GET    /api/reports/generate   // æ—¥å ±è‡ªå‹•ç”Ÿæˆï¼ˆå½“æ—¥ãƒ‡ãƒ¼ã‚¿é›†ç´„ï¼‰
```

##### åº—èˆ—ãƒã‚¹ã‚¿API (`/api/stores/*`)
```typescript
GET    /api/stores             // åº—èˆ—ä¸€è¦§å–å¾—
POST   /api/stores             // åº—èˆ—ä½œæˆï¼ˆMANAGER, ADMINå°‚ç”¨ï¼‰
GET    /api/stores/:id         // åº—èˆ—è©³ç´°å–å¾—
PUT    /api/stores/:id         // åº—èˆ—æ›´æ–°ï¼ˆMANAGER, ADMINå°‚ç”¨ï¼‰
DELETE /api/stores/:id         // åº—èˆ—å‰Šé™¤ï¼ˆADMINå°‚ç”¨ï¼‰
```

##### å•†å“ãƒã‚¹ã‚¿API (`/api/products/*`)
```typescript
GET    /api/products           // å•†å“ä¸€è¦§å–å¾—
POST   /api/products           // å•†å“ä½œæˆï¼ˆMANAGER, ADMINå°‚ç”¨ï¼‰
GET    /api/products/:id       // å•†å“è©³ç´°å–å¾—
PUT    /api/products/:id       // å•†å“æ›´æ–°ï¼ˆMANAGER, ADMINå°‚ç”¨ï¼‰
DELETE /api/products/:id       // å•†å“å‰Šé™¤ï¼ˆADMINå°‚ç”¨ï¼‰
```

#### APIãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼

**æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
{
  "success": true,
  "data": {
    "id": "clx1234567890",
    "name": "Example"
  },
  "message": "æ“ä½œãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ"
}
```

**ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "å…¥åŠ›å€¤ãŒä¸æ­£ã§ã™",
    "details": [
      {
        "field": "email",
        "message": "æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
      }
    ]
  }
}
```

---

### 3. ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ï¼ˆPrisma ORMï¼‰

#### Prismaè¨­å®š

**prisma/schema.prisma**:
- å‹å®‰å…¨ãªã‚¯ã‚¨ãƒªç”Ÿæˆ
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†
- ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®è‡ªå‹•è§£æ±º
- ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¯¾å¿œ

#### ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³

**ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆæ¤œè¨ä¸­ï¼‰**:
```typescript
// lib/repositories/visitRepository.ts
import { prisma } from '@/lib/prisma';
import type { Visit, Prisma } from '@prisma/client';

export class VisitRepository {
  async findMany(userId: string, filters?: VisitFilters) {
    return prisma.visit.findMany({
      where: {
        userId,
        visitDate: filters?.dateRange ? {
          gte: filters.dateRange.from,
          lte: filters.dateRange.to
        } : undefined
      },
      include: {
        store: true,
        visitProducts: {
          include: { product: true }
        }
      },
      orderBy: { visitDate: 'desc' }
    });
  }

  async create(data: Prisma.VisitCreateInput) {
    return prisma.visit.create({ data });
  }

  // ... ãã®ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰
}
```

---

### 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å±¤ï¼ˆPostgreSQLï¼‰

#### ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆåŸå‰‡
- æ­£è¦åŒ–ï¼ˆç¬¬3æ­£è¦å½¢ï¼‰
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–ï¼ˆé »ç¹ã«æ¤œç´¢ã•ã‚Œã‚‹åˆ—ï¼‰
- è«–ç†å‰Šé™¤ã®æ¡ç”¨ï¼ˆ`isActive`ãƒ•ãƒ©ã‚°ï¼‰
- ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ç®¡ç†ï¼ˆ`createdAt`, `updatedAt`ï¼‰

#### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æˆ¦ç•¥
```sql
-- è¨ªå•è¨˜éŒ²
CREATE INDEX idx_visits_user_id ON visits(user_id);
CREATE INDEX idx_visits_store_id ON visits(store_id);
CREATE INDEX idx_visits_visit_date ON visits(visit_date);

-- å—æ³¨
CREATE INDEX idx_orders_user_id ON orders(user_id);
CREATE INDEX idx_orders_store_id ON orders(store_id);
CREATE INDEX idx_orders_order_date ON orders(order_date);
CREATE INDEX idx_orders_order_number ON orders(order_number);

-- æ—¥å ±
CREATE INDEX idx_daily_reports_user_id ON daily_reports(user_id);
CREATE INDEX idx_daily_reports_report_date ON daily_reports(report_date);
CREATE INDEX idx_daily_reports_status ON daily_reports(status);
CREATE UNIQUE INDEX idx_daily_reports_user_date ON daily_reports(user_id, report_date);
```

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒªãƒ³ã‚°ï¼ˆPrismaå†…è”µï¼‰
- ã‚¯ã‚¨ãƒªæœ€é©åŒ–ï¼ˆN+1å•é¡Œå›é¿ï¼‰
- é©åˆ‡ãªãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆCascade, Restrictï¼‰

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ

### èªè¨¼ãƒ»èªå¯

#### NextAuth.jsè¨­å®š
```typescript
// lib/auth.ts
import NextAuth from 'next-auth';
import CredentialsProvider from 'next-auth/providers/credentials';
import bcrypt from 'bcryptjs';
import { prisma } from './prisma';

export const authOptions = {
  providers: [
    CredentialsProvider({
      name: 'Credentials',
      credentials: {
        email: { label: "Email", type: "email" },
        password: { label: "Password", type: "password" }
      },
      async authorize(credentials) {
        if (!credentials?.email || !credentials?.password) {
          return null;
        }

        const user = await prisma.user.findUnique({
          where: { email: credentials.email }
        });

        if (!user || !user.isActive) {
          return null;
        }

        const isValid = await bcrypt.compare(
          credentials.password,
          user.password
        );

        if (!isValid) {
          return null;
        }

        return {
          id: user.id,
          email: user.email,
          name: `${user.lastName} ${user.firstName}`,
          role: user.role
        };
      }
    })
  ],
  session: {
    strategy: 'jwt',
    maxAge: 24 * 60 * 60 // 24æ™‚é–“
  },
  callbacks: {
    async jwt({ token, user }) {
      if (user) {
        token.role = user.role;
        token.id = user.id;
      }
      return token;
    },
    async session({ session, token }) {
      if (session.user) {
        session.user.role = token.role;
        session.user.id = token.id;
      }
      return session;
    }
  },
  pages: {
    signIn: '/login',
    error: '/login'
  }
};
```

#### ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼ˆRBACï¼‰
```typescript
// lib/rbac.ts
export enum UserRole {
  SALES = 'SALES',
  MANAGER = 'MANAGER',
  ADMIN = 'ADMIN'
}

export const permissions = {
  visits: {
    create: [UserRole.SALES, UserRole.MANAGER, UserRole.ADMIN],
    read: [UserRole.SALES, UserRole.MANAGER, UserRole.ADMIN],
    update: [UserRole.SALES, UserRole.MANAGER, UserRole.ADMIN], // è‡ªåˆ†ã®ã¿
    delete: [UserRole.ADMIN]
  },
  reports: {
    approve: [UserRole.MANAGER, UserRole.ADMIN],
    reject: [UserRole.MANAGER, UserRole.ADMIN]
  },
  masters: {
    manage: [UserRole.MANAGER, UserRole.ADMIN]
  },
  users: {
    manage: [UserRole.ADMIN]
  }
};

export function hasPermission(
  userRole: UserRole,
  resource: string,
  action: string
): boolean {
  const allowedRoles = permissions[resource]?.[action] || [];
  return allowedRoles.includes(userRole);
}
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

| è„…å¨ | å¯¾ç­– | å®Ÿè£…æ–¹æ³• |
|------|------|---------|
| XSS | è‡ªå‹•ã‚¨ã‚¹ã‚±ãƒ¼ãƒ— | Reactæ¨™æº–æ©Ÿèƒ½ + CSPãƒ˜ãƒƒãƒ€ãƒ¼ |
| CSRF | ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼ | NextAuth.jsæ¨™æº–æ©Ÿèƒ½ |
| SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚° | Prisma ORM |
| èªè¨¼æƒ…å ±æ¼æ´© | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ– | bcrypt (salt rounds: 10) |
| ã‚»ãƒƒã‚·ãƒ§ãƒ³å›ºå®š | ã‚»ãƒƒã‚·ãƒ§ãƒ³å†ç”Ÿæˆ | NextAuth.jsæ¨™æº–æ©Ÿèƒ½ |
| ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ | ãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼ˆPhase 2ï¼‰ | next-rate-limit |

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ

### è¨ªå•è¨˜éŒ²ä½œæˆãƒ•ãƒ­ãƒ¼

```
[ãƒ¦ãƒ¼ã‚¶ãƒ¼]
    â”‚
    â”‚ 1. ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›
    â–¼
[VisitForm Component]
    â”‚
    â”‚ 2. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆZodï¼‰
    â–¼
[API: POST /api/visits]
    â”‚
    â”‚ 3. èªè¨¼ãƒã‚§ãƒƒã‚¯ï¼ˆNextAuthï¼‰
    â”‚ 4. æ¨©é™ãƒã‚§ãƒƒã‚¯ï¼ˆRBACï¼‰
    â–¼
[Prisma ORM]
    â”‚
    â”‚ 5. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹
    â”‚ 6. Visitä½œæˆ
    â”‚ 7. VisitProducté–¢é€£ä»˜ã‘
    â”‚ 8. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒŸãƒƒãƒˆ
    â–¼
[PostgreSQL]
    â”‚
    â”‚ 9. ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
    â–¼
[API Response]
    â”‚
    â”‚ 10. æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹
    â–¼
[VisitForm Component]
    â”‚
    â”‚ 11. ä¸€è¦§ç”»é¢ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    â–¼
[VisitList Component]
```

### æ—¥å ±è‡ªå‹•ç”Ÿæˆãƒ•ãƒ­ãƒ¼

```
[ãƒ¦ãƒ¼ã‚¶ãƒ¼]
    â”‚
    â”‚ 1. æ—¥å ±ä½œæˆç”»é¢ã‚¢ã‚¯ã‚»ã‚¹
    â–¼
[ReportForm Component]
    â”‚
    â”‚ 2. è‡ªå‹•ç”ŸæˆAPIå‘¼ã³å‡ºã—
    â–¼
[API: GET /api/reports/generate?date=2025-12-07]
    â”‚
    â”‚ 3. å½“æ—¥ã®è¨ªå•è¨˜éŒ²å–å¾—
    â”‚ 4. å½“æ—¥ã®å—æ³¨å–å¾—
    â”‚ 5. çµ±è¨ˆè¨ˆç®—ï¼ˆä»¶æ•°ã€é‡‘é¡ã€æ™‚é–“ï¼‰
    â–¼
[è‡ªå‹•ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯]
    â”‚
    â”‚ 6. ã‚µãƒãƒªãƒ¼æ–‡ç”Ÿæˆ
    â”‚ 7. è¨ªå•å…ˆãƒªã‚¹ãƒˆä½œæˆ
    â–¼
[API Response]
    â”‚
    â”‚ 8. ç”Ÿæˆãƒ‡ãƒ¼ã‚¿è¿”å´
    â–¼
[ReportForm Component]
    â”‚
    â”‚ 9. ãƒ•ã‚©ãƒ¼ãƒ ã«è‡ªå‹•å…¥åŠ›
    â”‚ 10. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰€æ„Ÿã‚’è¿½è¨˜
    â”‚ 11. æå‡º
    â–¼
[API: POST /api/reports]
```

---

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè¨­è¨ˆ

### æ¨å¥¨ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ

#### Option A: Vercel + Supabaseï¼ˆæ¨å¥¨ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Vercel (Frontend + API)       â”‚
â”‚  - Next.js App                          â”‚
â”‚  - Serverless Functions                â”‚
â”‚  - Edge Network (CDN)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Supabase                      â”‚
â”‚  - PostgreSQL Database                  â”‚
â”‚  - Connection Pooling                   â”‚
â”‚  - Automatic Backups                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ãƒ¡ãƒªãƒƒãƒˆ**:
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®çµ±åˆãƒ‡ãƒ—ãƒ­ã‚¤
- è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- CDNã«ã‚ˆã‚‹é«˜é€Ÿé…ä¿¡
- ç„¡æ–™æ ãŒå……å®Ÿ

#### Option B: AWSï¼ˆã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«æ§‹æˆï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           CloudFront (CDN)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           EC2 / ECS (Next.js App)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           RDS (PostgreSQL)              â”‚
â”‚  - Multi-AZ                             â”‚
â”‚  - Automated Backups                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç’°å¢ƒå¤‰æ•°ç®¡ç†

**å¿…é ˆç’°å¢ƒå¤‰æ•°**:
```bash
# Database
DATABASE_URL="postgresql://user:password@host:5432/sun_nippo"

# NextAuth
NEXTAUTH_URL="https://sun-nippo.example.com"
NEXTAUTH_SECRET="your-secret-key-minimum-32-characters"

# Optional (Phase 2)
AWS_S3_BUCKET="sun-nippo-attachments"
AWS_ACCESS_KEY_ID="your-aws-key"
AWS_SECRET_ACCESS_KEY="your-aws-secret"
```

---

## ğŸ“ˆ ç›£è¦–ãƒ»ãƒ­ã‚®ãƒ³ã‚°è¨­è¨ˆ

### ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«å®šç¾©

| ãƒ¬ãƒ™ãƒ« | ç”¨é€” | ä¾‹ |
|--------|------|---|
| ERROR | ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ | DBæ¥ç¶šå¤±æ•—ã€APIå‘¼ã³å‡ºã—ã‚¨ãƒ©ãƒ¼ |
| WARN | è­¦å‘Šäº‹é … | èªè¨¼å¤±æ•—ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ |
| INFO | ä¸»è¦ãªå‡¦ç† | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³ã€æ—¥å ±æå‡º |
| DEBUG | ãƒ‡ãƒãƒƒã‚°æƒ…å ± | ã‚¯ã‚¨ãƒªå®Ÿè¡Œã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ |

### ç›£è¦–é …ç›®

- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: APIå¿œç­”æ™‚é–“ã€DBã‚¯ã‚¨ãƒªå®Ÿè¡Œæ™‚é–“
- **å¯ç”¨æ€§**: ã‚¢ãƒƒãƒ—ã‚¿ã‚¤ãƒ ã€ã‚¨ãƒ©ãƒ¼ç‡
- **ãƒ“ã‚¸ãƒã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹**: æ—¥å ±æå‡ºæ•°ã€è¨ªå•ä»¶æ•°ã€å£²ä¸Šåˆè¨ˆ

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰

```
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   E2E    â”‚  10%
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Integrationâ”‚  30%
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  Unit Tests  â”‚  60%
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ†ã‚¹ãƒˆå®Ÿè£…

**ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆVitestï¼‰**:
```typescript
// __tests__/lib/validations.test.ts
import { describe, it, expect } from 'vitest';
import { visitSchema } from '@/lib/validations';

describe('visitSchema', () => {
  it('valid dataã§validationæˆåŠŸ', () => {
    const validData = {
      userId: 'user123',
      storeId: 'store456',
      visitDate: new Date('2025-12-07'),
      purpose: 'REGULAR'
    };
    expect(() => visitSchema.parse(validData)).not.toThrow();
  });

  it('å¿…é ˆé …ç›®ãŒæ¬ ã‘ã¦ã„ã‚‹å ´åˆã‚¨ãƒ©ãƒ¼', () => {
    const invalidData = {
      userId: 'user123'
    };
    expect(() => visitSchema.parse(invalidData)).toThrow();
  });
});
```

**çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆAPI Routesï¼‰**:
```typescript
// __tests__/api/visits.test.ts
import { describe, it, expect, beforeAll, afterAll } from 'vitest';
import { createMocks } from 'node-mocks-http';
import handler from '@/app/api/visits/route';

describe('/api/visits', () => {
  it('GET: è¨ªå•è¨˜éŒ²ä¸€è¦§ã‚’å–å¾—', async () => {
    const { req, res } = createMocks({ method: 'GET' });
    await handler(req, res);
    expect(res._getStatusCode()).toBe(200);
    expect(res._getJSONData()).toHaveProperty('data');
  });
});
```

**E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywright - Phase 2ï¼‰**:
```typescript
import { test, expect } from '@playwright/test';

test('è¨ªå•è¨˜éŒ²ä½œæˆãƒ•ãƒ­ãƒ¼', async ({ page }) => {
  await page.goto('/login');
  await page.fill('input[name="email"]', 'test@example.com');
  await page.fill('input[name="password"]', 'password123');
  await page.click('button[type="submit"]');

  await page.goto('/visits/new');
  await page.selectOption('select[name="storeId"]', 'store123');
  await page.click('button[type="submit"]');

  await expect(page).toHaveURL('/visits');
});
```

---

## ğŸ“¦ ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ•ãƒ­ãƒ¼

### CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '20'
      - run: npm ci
      - run: npm run typecheck
      - run: npm run lint
      - run: npm test

  deploy:
    needs: test
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: vercel/action@v1
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          vercel-args: '--prod'
```

---

## ğŸ”„ ä»Šå¾Œã®æ‹¡å¼µæ€§

### Phase 2æ‹¡å¼µè¨ˆç”»

- **å†™çœŸæ·»ä»˜æ©Ÿèƒ½**: AWS S3 + CloudFront
- **ãƒ¡ãƒ¼ãƒ«é€šçŸ¥**: SendGrid / AWS SES
- **CSVä¸€æ‹¬ç™»éŒ²**: Papa Parse + Batchå‡¦ç†
- **é«˜åº¦ãªåˆ†æ**: Chart.js / Recharts
- **PWAåŒ–**: Service Worker + Manifest

### ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£å¯¾ç­–

- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: Read Replicaè¿½åŠ ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°
- **ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°**: Rediså°å…¥ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ã€é »ç¹ãªã‚¯ã‚¨ãƒªï¼‰
- **CDN**: é™çš„ã‚¢ã‚»ãƒƒãƒˆã®é…ä¿¡æœ€é©åŒ–
- **API**: GraphQLå°å…¥æ¤œè¨ï¼ˆè¤‡é›‘ãªã‚¯ã‚¨ãƒªæœ€é©åŒ–ï¼‰

---

**ä½œæˆè€…**: CodeGenAgent (æº)
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
